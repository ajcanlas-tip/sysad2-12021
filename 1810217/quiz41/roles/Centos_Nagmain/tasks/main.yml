---
# tasks file for Centos_Nagmain
 - name: Downloading & Extracting Nagios Core
   unarchive:
     src: https://assets.nagios.com/downloads/nagioscore/releases/nagios-4.4.5.tar.gz
     dest: /tmp
     copy: NO

 - name: Configuring Nagios in Ubuntu
   command: ./configure --with-nagios-group=nagcmd --with-command-group=nagcmd --with-httpd_conf=/etc/apache2/sites-enabled
   args:
     chdir: /tmp/nagios-4.4.5

 - name: Cleaning Nagios
   make:
     chdir: /tmp/nagios-4.4.5
     target: clean

 - name: Nagios Compilation
   make:
     chdir: /tmp/nagios-4.4.5
     target: all

 - name: Installation of Nagios Compilation
   make:
     chdir: /tmp/nagios-4.4.5
     target: all

 - name: Nagios Compile Installing init
   make:
     chdir: /tmp/nagios-4.4.5
     target: install-init

 - name: Nagios Installing config
   make:
     chdir: /tmp/nagios-4.4.5
     target: install-config

 - name: Nagios Installing commandmode
   make:
     chdir: /tmp/nagios-4.4.5
     target: install-commandmode

 - name: Web Interface Installer
   make:
     chdir: /tmp/nagios-4.4.5
     target: install-webconf

 - name: Adduser account
   htpasswd:
     path: /usr/local/nagios/etc/htpasswd.users
     name: admin
     password: password

 - name: a2enmod cgi
   command: a2enmod cgi

 - name: Restarting Apache2
   service:
     name: apache2
     state: restarted
