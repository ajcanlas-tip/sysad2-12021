---
# tasks file for roles/c_nagios_service

- name: insallation of centos packages 
  dnf: 
    name: 
      - gcc
      - glibc 
      - glibc-common
      - gd
      - gd-devel 
      - perl
      - postfix 
      - wget 
    state: present 

- name: adding group nagiosxi 
  group: 
    name: nagiosxi 
    state: present

- name: user nagios 
  user: 
    name: nagios
    group: nagiosxi 

- name: nagios packages
  unarchive: 
    src: https://assets.nagios.com/downloads/nagioscore/releases/nagios-4.4.5.tar.gz 
    dest: /tmp 
    remote_src: yes 

- name: configuratiion of nagios 
  command: ./configure --with-command-group=nagiosxi 
  args: 
    chdir: /tmp/nagios-4.4.5 

- name: make clean 
  make: 
    target: clean
    chdir: /tmp/nagios-4.4.5

- name: make all
  make: 
    target: all 
    chdir: /tmp/nagios-4.4.5 

- name: make install
  make: 
    target: install
    chdir: /tmp/nagios-4.4.5 

- name: make install init
  make: 
    target: install-init
    chdir: /tmp/nagios-4.4.5

- name: daemoninit
  make:
    target: install-daemoninit
    chdir: /tmp/nagios-4.4.5 

- name: install config
  make: 
    target: install-config
    chdir: /tmp/nagios-4.4.5

- name: install commandmode
  make: 
    target: install-commandmode
    chdir: /tmp/nagios-4.4.5 

- name: install exfoliation
  make:
    target: install-exfoliation 
    chdir: /tmp/nagios-4.4.5 

- name: install webconf 
  make: 
    target: install-webconf
    chdir: /tmp/nagios-4.4.5

- name: passlib
  pip:
    name: passlib

- name: user authenticator 
  htpasswd: 
    path: /usr/local/nagios/etc/htpasswd.users
    name: user
    password: password 

- name: restarting httpd
  service: 
    name: httpd
    enabled: yes
    state: restarted 































