---
  - name: Installing Apache and Updating the Firewall
    hosts: ubuntu

    tasks:
            - name: Install Apache using package manager
              apt:
                      name: install apache2
                      state: latest
                      update_cache: yes

            - name: start apache2 service in Ubuntu
              service:
                      name: apache2
                      state: restarted
                      enabled: yes

            - name: allow UFW in apache2
              ufw:
                      rule: allow
                      port: '80'
                      proto: tcp
                      state: enabled

  - name: Installing MySQL
    hosts: ubuntu

    tasks:
        - name: Installing mysql server
          apt:
                  name: mysql-server
                  state: latest

        - name: Starting the MySQL server
          becom: yes
          become_user: root
          service:
                  name: mysql
                  state: started
                  enabled: yes

  - name: PHP Packages
    hosts: ubuntu

    tasks:
            - name: Installing PHP Packages
              apt:
                      name:
                              - php
                              - php-mysql
                              - libapache2-mod-php

  - name: Creating Virtual host for my Website
    hosts: ubuntu

    tasks:
            - name: creating index.html
              copy:
                      content: "<h1> Test String </h1> <br> Created index.html"
                      dest: /var/www/html/index.html
                      owner: root
                      group: root
                      mode: '0644'

  - name: Testing PHP process
    hosts: ubuntu

    tasks:
            - name: Test PHP
              copy:
                      scr: ./edit.html
                      dest: /var/www/html/info.php
                      owner: root
                      group: root
                      mode: '0644'
