---
# tasks file for httpd
- name: Install apache2 using APT
  apt:
    name: apache2
    state: present
    update_cache: yes

- name: Create /var/www/qzkmcruz directory for config
  file:
    path: /var/www/qzkmcruz
    state: directory
    owner: qzkmcruz
    group: qzkmcruz
    mode: '0755'

- name: Inserting config in the created directory
  copy:
    content: |
      <VirtualHost *:110>
      ServerName qzkmcruz
      ServerAlias www.qzkmcruz
      DocumentRoot /var/www/qzkmcruz
      ErrorLog ${APACHE_LOG_DIR}/error.log
      CustomLog ${APACHE_LOG_DIR}/access.log combined
      </VirtualHost>
    dest: /etc/apache2/sites-available/qzkmcruz.conf
    owner: qzkmcruz
    group: qzkmcruz
    mode: '0755'

- name: Set the host on top of default
  shell: sudo a2ensite qzkmcruz; a2dissite 000-default

- name: Create the landing page under qzkmcurz directory
  copy:
    src: landing.html
    dest: /var/www/qzkmcruz/index.html
    owner: qzkmcruz
    group: qzkmcruz
    mode: '0755'

- name: Restart services
  service:
    name: apache2
    state: restarted


