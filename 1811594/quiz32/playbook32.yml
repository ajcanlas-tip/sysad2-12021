---
 - name: Install and configure httpd server
   hosts: Ubuntu

   tasks:
    - name: Install Apache2
      apt: 
         name: apache2
         state: latest
         update_cache: yes
      
    - name: Allow Installation through Firewall
      ufw:
        rule: allow
        direction: in
        name: 'Apache'
   
    - name: Create Directories
      file: 
        name: /var/www/Quiz32
        state: directory
        owner: nobody
        group: nogroup
    
    - name: Create HTML File
      copy:
        src: index.html
        dest: /var/www/Quiz32
    
    - name: Configuring Directory
      copy:
        src: /etc/apache2/sites-available/000-default.conf
        remote_src: yes
        dest: /quiz32.conf
   
    - name: Copy Default File
      copy:
        src: /quiz32.conf
        remote_src: yes
        dest: /etc/apache2/sites-available
   
    - name: editing quiz32 document root
      replace:
        path: /etc/apache2/sites-available/quiz32.conf
        regexp: '/var/www/html'
        replace: '/var/www/Quiz32'
   
    - name: create editin server admin
      replace:
        path: /etc/apache2/sites-available/quiz32.conf
        regexp: "ServerAdmin webmaster@localhost"
        replace: "ServerAdmin qrsimbulan@qrsimbulan"
   
    - name: Editing server name
      replace:
        path: /etc/apache2/sites-available/quiz32.conf
        regexp: "#ServerName www.example.com"
        replace: "#ServerName www.quiz32.com"
   
    - name: Activating Virtualhost
      command: a2ensite quiz32.conf
    
    - name: reload Apache2
      service:
        name: apache2
        state: reloaded
