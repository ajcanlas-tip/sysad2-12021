---
# tasks file for roles/u_GPI

- name: Install package from grafana 
  apt: 
    deb: https://dl.grafana.com/oss/release/grafana_7.3.6_amd64.deb
  register: pkg_grafana 

- name: Depackig of grafana 
  dpkg_selections: 
    name: grafana_7.3.6_amd64.deb 
    selection: install
  when: pkg_grafana.changed

- name: installation of libfontconfig
  apt: 
    name: libfontconfig1
    state: latest
    update_cache: yes 

- name: installation of grafana 
  apt: 
    name: grafana 
    state: latest
    update_cache: yes 

- name: enabling grafana 
  service: 
    name: grafana-server 
    state: started 
    enabled: yes 

- name: Installation of prometheus 
  apt: 
    name: prometheus 
    state: latest
    update_cache: yes 

- name: start prometheus 
  service: 
    name: prometheus 
    state: started 
    enabled: yes 

- name: influxdata repository 
  apt_repository:
    repo: 'deb https://repos.influxdata.com/ubuntu focal stable' 
    state: present 

- name: installation of telegraf 
  apt: 
    name: telegraf 
    state: latest
    update_cache: yes 

- name: start telegraf
  service: 
    name: telegraf 
    state: started 


























