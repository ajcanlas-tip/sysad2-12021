---
- name: Ubuntu Installing
  hosts: ubuntu
  
  tasks:
    - name: Update Ubuntu using apt
      apt:
        update_cache: YES

    - name: Install Apache using Ubuntu's Package Manager
      apt:
        name: apache2
        state: latest

    - name: Start the Apache2 Service
      service:
        name: apache2
        state: started
        enabled: YES

    - name: Configuring the Whitelist Apache2 in ufw
      ufw:
        rule: allow
        port: '80'
        proto: tcp
      loop:
        - 80
        - 22
    
- name: Install the MySQL-Server
  hosts: ubuntu

  tasks:
    - name: Install the MySQL-Server
      apt:
        name: mysql-server
        state: latest

    - name: Start the mysql
      service:
        name: mysql
        state: started
        enabled:  YES

- name: Install the PHP Packages
  hosts: ubuntu

  tasks:
    - name: Installing PHP Packages
      apt:
        name:
          - php
          - php-mysql
          - libapache2-mod-php

- name: Virtual Host
  hosts: ubuntu

  tasks:
    - name: HTML
      copy:
        content: " Quiz 2.2 "
        dest: /var/www/html/index.html
        owner: root
        group: root
        mode: '0644'
