---
# tasks file for roles/happy
- name: Installing required Packages
  apt:
   name:
    - apache2
    - libapache2-mod-php
    - build-essential
    - libgd-dev
    - unzip
   state: latest
   update_cache: yes

- name: Creating nagios group
  group:
   name: nagios
   state: present

- name: Creating nagios group
  group:
   name: nagcmd
   state: present

- name: Creating Nagios User
  user:
   name: nagios
   shell: /bin/bash
   comment: nagios user
   group: nagios
   password: $5$6kK2BJSMUP6s7v7H$lSY.2f/g8oZTm6aftq1DUxdvOSwq/jM6HoD9BplO1zC

- name: Adding nagios user group for External Command
  user:
   name: nagios
   groups: nagcmd
   append: yes

- name: Adding www-data user group for External Command
  user:
   name: www-data
   groups: nagcmd
   append: yes


- name: Creating downloads directory
  file:
   path: /downloads
   state: directory
   owner: nobody
   group: nogroup

- name: Downloading Nagios
  get_url:
   url: http://prdownloads.sourceforge.net/sourceforge/nagios/nagios-4.2.1.tar.gz
   dest: /downloads

- name: Downloading Plugins
  get_url:
   url: https://nagios-plugins.org/download/nagios-plugins-2.3.3.tar.gz
   dest: /downloads
