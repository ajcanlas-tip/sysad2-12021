---

- name: install and configure http server
  hosts: ubuntu

  tasks:
   - name: install Apache2
     apt:
      name: apache2
      state: latest
      update_cache: yes

   - name: creating directory for website
     file:
      name: /var/www/directory
      state: directory
      owner: nobody
      group: nogroup

   - name: create html file
     copy:
      src: index.html
      dest: /var/www/directory

   - name: configuring directory
     copy:
      src: /etc/apache2/sites-available/000-default.conf
      remote_src: yes
      dest: /quiz32.conf

   - name: copy default file
     copy:
      src: /quiz32.conf
      remote_src: yes
      dest: /etc/apache2/sites-available

   - name: editing quiz32 document root
     replace:
      path: /etc/apache2/sites-available/quiz32.conf
      regexp: '/var/www/html'
      replace: '/var/www/directory'

   - name: create editin server admin
     replace:
      path: /etc/apache2/sites-available/quiz32.conf
      regexp: "ServerAdmin webmaster@localhost"
      replace: "ServerAdmin qcosalon@qcosalon"

   - name: Editing server name
     replace:
      path: /etc/apache2/sites-available/quiz32.conf
      regexp: "#ServerName www.example.com"
      replace: "#ServerName www.quiz32.com"

   - name: Activating Virtualhost
     command: a2ensite quiz32.conf

   - name: reload Apache2
     service:
      name: apache2
      state: reloaded        
